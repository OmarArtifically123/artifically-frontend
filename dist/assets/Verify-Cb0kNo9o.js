import{u as e,t as i,a as s,p as r,j as a,T as t,c as n}from"./index-1DIB5rGU.js";import{e as o,r as l,u as d}from"./vendor-DO1dN4GI.js";import"./performance-Bp-PRVTn.js";import"./api-7w58lNoV.js";import"./graphql-MaKh5oBd.js";const c=n(e=>a.jsxs("slot",{children:[a.jsx("h2",{style:e.v0,children:"Verifying your email…"}),a.jsx("div",{className:"loading",style:e.v1})]}),{name:"Verify_1"}),m=n(e=>a.jsxs("slot",{children:[a.jsx("h2",{style:e.v0,children:"✅ Verified! Redirecting…"}),a.jsx("p",{style:e.v1,children:"Hang tight, taking you to the dashboard."})]}),{name:"Verify_2"}),v=n(e=>a.jsxs("slot",{children:[a.jsx("h2",{style:e.v0,children:"Verification error"}),a.jsx("p",{style:e.v1,children:"We couldn’t verify that link. The token may have expired."}),a.jsx("button",{className:"btn btn-primary",disabled:e.v2,onClick:e.v3,children:e.v4})]}),{name:"Verify_3",portals:["v4"]}),p=function({onVerified:n}){const{darkMode:p}=e(),[u]=o(),[f,g]=l.useState("loading"),[h,y]=l.useState(""),[x,j]=l.useState(!1),b=d();l.useEffect(()=>{const e=u.get("token");if(!e)return g("error"),void i("Missing verification token",{type:"error"});(async()=>{var a,t;try{await s.get("/auth/verify-email",{params:{token:e}}).then(r());try{const e=await s.get("/auth/me").then(r("user"));e&&(null==n||n(e),y(e.email))}catch{}g("success"),i("Email verified! You’re good to go.",{type:"success"}),setTimeout(()=>b("/dashboard"),1500)}catch(o){g("error");const e=(null==(t=null==(a=null==o?void 0:o.response)?void 0:a.data)?void 0:t.message)||(null==o?void 0:o.message)||"Verification failed";i(e,{type:"error"})}})()},[]);const V=e=>a.jsx("section",{style:{padding:"6rem 0"},children:a.jsxs("div",{className:"container",style:{maxWidth:"640px",margin:"0 auto",display:"grid",gap:"1.5rem",textAlign:"center",background:p?"rgba(15,23,42,0.75)":"rgba(255,255,255,0.95)",borderRadius:"1.5rem",padding:"3rem",border:"1px solid "+(p?"rgba(148,163,184,0.25)":"rgba(148,163,184,0.35)"),boxShadow:p?"0 35px 65px rgba(8, 15, 34, 0.55)":"0 35px 65px rgba(148, 163, 184, 0.35)"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("div",{style:{fontWeight:700,color:p?"#cbd5e1":"#475569"},children:"Email verification"}),a.jsx(t,{})]}),e]})});return V("loading"===f?a.jsx(c,{v0:{fontSize:"1.75rem"},v1:{width:"40px",height:"40px",margin:"0 auto"}}):"success"===f?a.jsx(m,{v0:{fontSize:"1.75rem",color:p?"#6ee7b7":"#047857"},v1:{color:p?"#94a3b8":"#475569"}}):a.jsx(v,{v0:{fontSize:"1.75rem",color:p?"#fda4af":"#b91c1c"},v1:{color:p?"#94a3b8":"#475569"},v2:x,v3:async()=>{var e,r;if(h)try{j(!0),await s.post("/auth/resend-verification",{email:h}),i("Verification email resent",{type:"success"})}catch(a){const s=(null==(r=null==(e=null==a?void 0:a.response)?void 0:e.data)?void 0:r.message)||(null==a?void 0:a.message)||"Resend failed";i(s,{type:"error"})}finally{j(!1)}else i("No email found. Please sign in first.",{type:"error"})},v4:x?"Resending…":"Resend Verification Email"}))};export{p as default};
