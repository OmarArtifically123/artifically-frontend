var y=(d,s,n)=>new Promise((p,o)=>{var h=a=>{try{c(n.next(a))}catch(m){o(m)}},f=a=>{try{c(n.throw(a))}catch(m){o(m)}},c=a=>a.done?p(a.value):Promise.resolve(a.value).then(h,f);c((n=n.apply(d,s)).next())});import{f as E,r as u,u as R,j as e}from"./react-vendor-bEOajVqR.js";import{u as w,t as l,b,p as v,s as j,T}from"./index-CrGJeRyx.js";import"./vendor-CtYYAZJ3.js";import"./three-vendor-7241h_j-.js";import"./framer-vendor-DE1cJCbf.js";import"./gsap-vendor-DSkmy12n.js";function P({onVerified:d}){const{darkMode:s}=w(),[n]=E(),[p,o]=u.useState("loading"),[h,f]=u.useState(""),[c,a]=u.useState(!1),m=R();u.useEffect(()=>{const r=n.get("token");if(!r){o("error"),l("Missing verification token",{type:"error"});return}y(this,null,function*(){var g,i;try{yield b.get("/auth/verify-email",{params:{token:r}}).then(v());try{const t=yield b.get("/auth/me").then(v("user"));t&&(d==null||d(t),f(t.email))}catch(t){}o("success"),l("Email verified! You’re good to go.",{type:"success"}),setTimeout(()=>m("/dashboard"),1500)}catch(t){o("error");const S=((i=(g=t==null?void 0:t.response)==null?void 0:g.data)==null?void 0:i.message)||(t==null?void 0:t.message)||"Verification failed";l(S,{type:"error"})}})},[]);const k=()=>y(this,null,function*(){var r,g;if(!h){l("No email found. Please sign in first.",{type:"error"});return}try{a(!0),yield b.post("/auth/resend-verification",{email:h}),l("Verification email resent",{type:"success"})}catch(i){const t=((g=(r=i==null?void 0:i.response)==null?void 0:r.data)==null?void 0:g.message)||(i==null?void 0:i.message)||"Resend failed";l(t,{type:"error"})}finally{a(!1)}}),x=r=>e.jsx("section",{style:{padding:`${j("2xl",1.5)} 0`},children:e.jsxs("div",{className:"container",style:{maxWidth:"640px",margin:"0 auto",display:"grid",gap:j("md"),textAlign:"center",background:s?"rgba(15,23,42,0.75)":"rgba(255,255,255,0.95)",borderRadius:"1.5rem",padding:j("xl"),border:`1px solid ${s?"rgba(148,163,184,0.25)":"rgba(148,163,184,0.35)"}`,boxShadow:s?"0 35px 65px rgba(8, 15, 34, 0.55)":"0 35px 65px rgba(148, 163, 184, 0.35)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{fontWeight:700,color:s?"#cbd5e1":"#475569"},children:"Email verification"}),e.jsx(T,{})]}),r]})});return x(p==="loading"?e.jsxs(e.Fragment,{children:[e.jsx("h2",{style:{fontSize:"1.75rem"},children:"Verifying your email…"}),e.jsx("div",{className:"loading",style:{width:"40px",height:"40px",margin:"0 auto"}})]}):p==="success"?e.jsxs(e.Fragment,{children:[e.jsx("h2",{style:{fontSize:"1.75rem",color:s?"#6ee7b7":"#047857"},children:"✅ Verified! Redirecting…"}),e.jsx("p",{style:{color:s?"#94a3b8":"#475569"},children:"Hang tight, taking you to the dashboard."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{style:{fontSize:"1.75rem",color:s?"#fda4af":"#b91c1c"},children:"Verification error"}),e.jsx("p",{style:{color:s?"#94a3b8":"#475569"},children:"We couldn’t verify that link. The token may have expired."}),e.jsx("button",{className:"btn btn-primary",disabled:c,onClick:k,children:c?"Resending…":"Resend Verification Email"})]}))}export{P as default};
